---
layout: default
---
{%- comment -%}Establish the fancy content_path slug{%- endcomment -%}
{%- assign len = page.path | size | minus: 12 -%}
{%- assign content_path = page.path | slice: 9, len -%}

{%- comment -%}Populate tags: an array of a-tags linking to the topical tags{%- endcomment -%}
{%- assign tagslugs = '' | split: '' -%}
{%- if page.course -%}
    {%- assign tagslugs = tagslugs | push: page.course -%}
{%- endif -%}
{%- if page.tags.size > 0 -%}
    {%- assign tagslugs = tagslugs | concat: page.tags -%}
{%- endif -%}
{%- assign tags = '' | split: '' -%}
{%- for t in tagslugs -%}
    {%- assign tag = site.tags | where: "slug", t | first -%}
    {%- if tag -%}
        {%- capture taglink -%}<a href="{{ tag.url }}">{{ tag.title }}</a>{%- endcapture -%}
        {%- assign tags = tags | push: taglink -%}
    {%- endif -%}
{%- endfor -%}
{%- if tags.size == 0 -%}{%- assign tags = nil -%}{%- endif -%}

{%- comment -%}Calculate star rating and find featured_post{%- endcomment -%}
{%- assign stars = nil -%}
{%- assign featured_post = nil -%}
{%- if page.status == 'rejected' -%}{%- assign stars = 1 -%}{%- else -%}
    {%- unless page.course -%}{%- assign stars = 2 -%}{%- endunless -%}
{%- endif -%}
{%- unless stars -%}
    {%- if page.status == 'featured' -%}
        {%- assign stars = 4 -%}
        {%- if page.external_url or page.file_links or page.drive_links -%}
            {%- for p in site.posts -%}
                {%- if p.content contains page.slug -%}
                    {%- assign stars = 5 -%}
                    {%- assign featured_post = p -%}
                    {%- break -%}
                {%- endif -%}
            {%- endfor -%}
        {%- endif -%}
    {%- else -%}
        {%- assign stars = 3 -%}
    {%- endif -%}
{%- endunless -%}

{%- assign category = site.categories | where: "slug", page.category | first -%}

<article class="content-perma">

  <header class="post-header">
    <div class="back"><a href="/content/">Content</a> / <a href="/content/{{ page.category }}/">{{ category.title }}</a> /</div>
    {% assign title = page.title | markdownify | remove: '<p>' | remove: '</p>' | split: ": " %}
    <h1 class="post-title">{% include content_icon.html category=page.category %} {{ title | first }}</h1>
    {% if title.size > 1 %}<h2 class="post-subtitle">{{ title | shift | join: ": " }}</h2>{% endif %}
    {% if page.authors.size > 0 %}<h2 class="author">
        By {% include content_authors_string.html content=page hide_reader=true link=true %}
    </h2>{% endif %}
    {% if page.reader %}
    {% assign reader = site.authors | where: "slug", page.reader | first %}
    <h2 class="author">Read by {% if reader %}<a href="{{ reader.url }}">{{ reader.title }}</a>{% else %}{{ page.reader }}{% endif %}</h2>
    {% endif %}
    {% assign translator = site.authors | where: "slug", page.translator | first %}

{%- comment -%}Unnecessary given the footer text?
    <div class="content_rating">
        <div class="star_rating">{% for i in (1..5) %}<i class="fa{% if i > stars %}r{% else %}s{% endif %} fa-star"></i>{% endfor %}</div>
    </div>
{%- endcomment -%}

    {% if page.source_url or page.external_url or page.file_links or page.drive_links.size > 0 %}
        <p class="content_links">
        {% assign value = page.base_value %}{% if page.status=="featured" %}{% assign value = value | times: site.data.ga.featured_value_multiplier %}{% endif %}
         {% if page.external_url %}
            <a class="btn" target="_blank" data-content-path="{{ content_path }}" ga-event-value="{{ value }}" href="{{ page.external_url }}"><i class="fa{% if page.external_url contains "youtu" %}b fa-youtube"></i> YouTube{% else %}s fa-{% assign ext = page.external_url | slice: -4, 4 %}{% if ext == ".mp3" %}volume-up{% else %}globe{% endif %}"></i> Online{% endif %}</a>
        {% endif %}
        {% if page.file_links.size > 0 %}
            {% for link in page.file_links %}
                {% assign i = forloop.index | minus: 1 %}
                <a class="btn" target="_blank" ga-event-value="{{ value }}" data-content-path="{{ content_path }}" ga-event-label="{{ link }}" href={{ site.data.content.filehost | append: link }}><i class="fa{% case page.formats[i] %}{% when "pdf" %}r fa-file-pdf{% when "mp3" %}r fa-file-audio{% when "m4a" %}r fa-file-audio{% when "epub" %}s fa-tablet-alt{% when "png" %}r fa-file-image{% when "mp3s" %}r fa-file-open{% when "zip" %}r fa-file-archive{% when "pdfs" %}r fa-file-open{% when "wma" %}r fa-file-audio{% else %}r fa-file{% endcase %}"></i> {{ page.formats[i] }}</a>
            {% endfor %}
        {% endif %}
        {% if page.drive_links.size > 0 %}
            {% for link in page.drive_links %}
                {% assign i = forloop.index | minus: 1 %}
                <a class="btn" target="_blank" ga-event-value="{{ value }}" data-content-path="{{ content_path }}" ga-event-label="drive.google.com/{{ content_path }}.{{ page.formats[i] }}" href={{ link }}><i class="fa{% if link contains "drive.google.com" %}b fa-google-drive{% else %}s fa-globe{% endif %}"></i> {{ page.formats[i] }}</a>
            {% endfor %}
        {% endif %}
        {% if page.source_url %}<span class="source">
        adapted from <a href="{{ page.source_url }}" ga-event-value="{{ value }}" target="_blank">this original</a>.
        </span>{% endif %}
        </p>
    {% endif %}

 </header>
  <div class="post-content">
        {{ content }}
  </div>

  <footer>
    {% if page.series %}{% assign series = site.series | where: "slug", page.series | first %}{% endif %}
    {% if page.journal %}{% assign journal = site.journals | where: "slug", page.journal | first %}{% endif %}
    {% if page.publisher %}{% assign publisher = site.publishers | where: "slug", page.publisher | first %}{% endif %}
    {% if page.editor %}{% assign editor = site.authors | where: "slug", page.editor | first %}{% endif %}
    <p><i>
        {% if page.translator %} Translated by {% if translator %}<a href="{{ translator.url }}#translations">{{ translator.title }}</a>{% else %}{{ page.translator }}{% endif %}.{% endif %}
        {% if page.year or page.publisher or page.booktitle or page.journal or series %}Published{% if page.year %} in {{ page.year }}{% endif %}{% if page.journal %} in {% if journal %}<a href="{{ journal.url }}">{{ journal.title }}</a>{% else %}{{ page.journal }}{% endif %}{% endif %}{% if page.booktitle %} in “{{ page.booktitle }}”{% endif %}{% if page.editor %} ({% if editor %}<a href="{{ editor.url }}">{{ editor.title }}</a>{% else %}{{ page.editor | split: " and " | array_to_sentence_string }}{% endif %} ed.){% endif %}{% if page.publisher %} by {% if publisher %}<a href="{{ publisher.url }}">{{ publisher.title }}</a>{% else %}{{ page.publisher }}{% endif %}{% if page.address or publisher.address %}, {{ page.address | default: publisher.address }}{% endif %}{% endif %}{% if series %} {% if page.number %}as{% else %}in{% endif %} <a href="{{ series.url }}">{{ series.title }}</a>{% if page.number %} number {{ page.number }}{% endif %}{% endif %}.{% endif %}
    </i></p>
    
   <p class="star_desc">
        {% assign joiner = "or" %}
        {% case stars %}
        {% when 1 %}
            {% assign joiner = "and" %}I no longer recommend this work{% if tags %} for studying {% else %}.{% endif %}
        {% when 2 %}
            {% assign joiner = "and" %}{% if tags %}Tags: {% endif %} 
        {% when 3 %}
            Recommended for those who have a keen interest in {% unless tags %} this kind of thing.{% endunless %}
        {% when 4 %}
            Recommended for everyone{% if tags %} interested in {% else %}.{% endif %}
        {% else %}
            One of the best works in existence{% if tags %} on {% else %}.{% endif %}
        {% endcase %}
        {% if tags %}{{ tags | array_to_sentence_string: joiner }}.{% endif %}
      <i>See <a href="{% link tags.md %}">all of our tags here</a>.</i>
    </p>
 
    {% if page.course %}
        {% assign course = site.courses | where: "slug", page.course | first %}
        {% if course or featured_post %}<p><i>Featured in 
            {% if featured_post %}<a href="{{ featured_post.url }}">the {{ featured_post.date | date: "%B %Y" }} newsletter</a>{% if course %} and {% else %}.{% endif %}{% endif %}
            {% if course %}the course, "<a href="{{ course.url }}#{{ page.slug }}"><i style="font-style: italic;" class="{{ course.icon }}"></i> {{ course.title }}</a>."{% endif %}
        </i></p>{% endif %}
    {% endif %}
    <details class="Box--condensed bibtex" ontoggle="deetstoggler();">
      <summary class="Box-header">Bibtex Info</summary>
      <script>function deetstoggler(e) {
        var k = "{{ content_path }}.bibtex.toggled";
        if (!localStorage.getItem(k)) {
          ga('send','event','Bibtex','firstopen','{{ content_path }}');
          localStorage.setItem(k, 1);
        }
      }</script>
      <div>
{% capture bibtex %}{% include content.bibtex content=page %}{% endcapture %}
{% capture md %}```tex
{{ bibtex }}```{% endcapture %}{{ md | markdownify }}
      <button ga-on="click" ga-event-category="Bibtex" ga-event-action="copy" ga-event-label="{{ content_path }}" class="btn copybutton" data-clipboard-text="{{ bibtex | replace: '"', "'" }}"><i class="fas fa-copy"></i> Copy to clipboard</button>
      <script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
      <script>
var cb = new ClipboardJS('.copybutton');
cb.on('success', function(e){showTooltip(e.trigger,'Copied');});
cb.on('error', function(e){showTooltip(e.trigger,'Error');});

function clearTooltip(){this.setAttribute('class','btn copybutton');this.removeAttribute('aria-label');}
function showTooltip(elem,msg){elem.setAttribute('class','btn copybutton tooltipped tooltipped-n');elem.setAttribute('aria-label',msg); setTimeout(clearTooltip.bind(elem), 4000);}
      </script>
      </div>
    </details>
  {% include similar_content_footer.html category=category content=page %}
  </footer>

</article>
